<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FEU Grade Calculator — Launch Activator</title>
  <meta name="description" content="Launch FEU Grade Calculator Activator" />
  <link rel="canonical" href="https://feu.jareddo06.ovh/" />
  <link rel="icon" href="https://ssl.gstatic.com/docs/doclist/images/icon_11_spreadsheet_list.png" type="image/png" />
  <style>
    :root {
      --bg: #fafafa;
      --card: #fff;
      --accent: #1a237e;
      --accent2: #2e7d32;
      --muted: #555;
      --maxw: 880px;
    }
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--bg);
      color: #222;
      margin: 0;
      line-height: 1.6;
    }
    header {
      background: var(--accent);
      color: white;
      text-align: center;
      padding: 48px 16px 56px;
    }
    header h1 { margin: 0; font-size: 2rem; letter-spacing: 0.3px; }
    header p { max-width: 700px; margin: 10px auto 0; font-weight: 400; font-size: 1.05rem; opacity: 0.9; }
    main { max-width: var(--maxw); background: var(--card); margin: -40px auto 60px; border-radius: 14px; box-shadow: 0 6px 30px rgba(0,0,0,0.08); padding: 36px 30px; }
    .cta { display:inline-block; background:var(--accent2); color:white; padding: 14px 24px; border-radius:8px; font-weight:600; font-size:1rem; border:none; cursor:pointer; text-decoration:none; }
    .cta:hover { background:#256427; }
    label { font-weight:600; display:block; margin-top:12px; }
    input[type="text"] { width:100%; padding:12px; margin-top:8px; border-radius:6px; border:1px solid #ccc; font-size:1rem; }
    p.note { color:var(--muted); margin-top:12px; }
    footer { text-align:center; font-size:13px; color:var(--muted); margin-top:40px; }
    footer a { color:var(--accent); }
  </style>
</head>
<body>
  <header>
    <h1>FEU Grade Calculator</h1>
    <p>Paste your Spreadsheet URL or ID below to open the Activator.</p>
  </header>

  <main>
    <label for="sheetInput">Spreadsheet URL or ID</label>
    <input id="sheetInput" type="text" placeholder="Paste full URL or just the ID (e.g. 1OGZKkXOVmqk...)" />
    <div style="margin-top:14px;">
      <button id="openActivatorBtn" class="cta">Open Activator</button>
    </div>

    <p class="note">If you have the sheet open, copy the long string between <code>/d/</code> and <code>/edit</code> from the URL. The Activator will open and prompt you to authorize if required.</p>
  </main>

  <footer>
    <p>© 2025 FEU Grade Calculator — <a href="/privacy">Privacy Policy</a></p>
  </footer>

  <script>
    // Extracts spreadsheet ID from a pasted URL or raw ID
    function extractId(input) {
      if (!input) return "";
      input = input.trim();
      // If it looks like a full URL with /d/<id>/
      const match = input.match(/\/d\/([a-zA-Z0-9-_]{20,})/);
      if (match && match[1]) return match[1];
      // If it looks like just the id
      const idOnly = input.match(/^([a-zA-Z0-9-_]{20,})$/);
      if (idOnly && idOnly[1]) return idOnly[1];
      return "";
    }

    document.getElementById("openActivatorBtn").addEventListener("click", () => {
      const v = document.getElementById("sheetInput").value;
      const id = extractId(v);
      if (!id) {
        alert("Please paste a valid spreadsheet URL or ID.");
        return;
      }
      // redirect to /app with id param
      window.location.href = `/app?id=${encodeURIComponent(id)}`;
    });

    // Optional: if the page is opened with ?id= prefill the input (handy for linking from a sheet)
    const urlId = new URLSearchParams(window.location.search).get("id");
    if (urlId) document.getElementById("sheetInput").value = urlId;
  </script>
</body>
</html>
